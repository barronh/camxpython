
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/maps/ex_maps_01_compare.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_maps_ex_maps_01_compare.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_maps_ex_maps_01_compare.py:


Compare Two CAMx Runs
=====================

.. GENERATED FROM PYTHON SOURCE LINES 8-10

Configuration
'''''''''''''

.. GENERATED FROM PYTHON SOURCE LINES 10-20

.. code-block:: Python


    # date to process
    date = '20160610'
    # file to use as input
    oldpath = f'../../camx/outputs/CAMx.v7.32.36.12.{date}.3D.avrg.grd02.nc'
    # file to create
    newpath = f'../../camx/outputs/CAMx.v7.32.36.12.{date}.3D_EDIT.avrg.grd02.nc'
    # figure demonstrating the change
    figpath = 'outputs/ozone_compare.png'


.. GENERATED FROM PYTHON SOURCE LINES 21-23

Imports and File Prep
'''''''''''''''''''''

.. GENERATED FROM PYTHON SOURCE LINES 23-33

.. code-block:: Python


    import pyrsig
    import pycno
    import numpy as np
    import os
    import matplotlib.pyplot as plt
    import matplotlib.colors as mc

    os.makedirs('outputs', exist_ok=True)


.. GENERATED FROM PYTHON SOURCE LINES 34-38

Open Files
''''''''''
- Open the existing file in read-only mode
- Open the new file in read-only append mode

.. GENERATED FROM PYTHON SOURCE LINES 38-43

.. code-block:: Python


    oldfile = pyrsig.open_ioapi(oldpath)
    newfile = pyrsig.open_ioapi(newpath)



.. GENERATED FROM PYTHON SOURCE LINES 44-46

Plot Comparison
'''''''''''''''

.. GENERATED FROM PYTHON SOURCE LINES 46-71

.. code-block:: Python



    oldfile = pyrsig.open_ioapi(oldpath)
    newfile = pyrsig.open_ioapi(newpath)

    key = 'O3'
    compfile = newfile[[]]
    compfile['New'] = newfile[key].isel(LAY=0).max('TSTEP') * 1000
    compfile['Old'] = oldfile[key].isel(LAY=0).max('TSTEP') * 1000
    Z = compfile.to_dataarray(dim='version')
    Z.attrs.update(oldfile[key].attrs, units='ppb')
    fca = Z.plot(col='version', norm=mc.Normalize(0))

    dZ = np.abs(compfile['New'] - compfile['Old'])
    levels = [1, 5, 10]
    for ax in fca.axs.ravel():
        cs = dZ.plot.contour(levels=levels, colors=['grey', 'w', 'r'], ax=ax, add_labels=False)

    cl, clbl = cs.legend_elements()
    clbl = [f'+{v:.0f}ppb' for v in levels]
    ax.legend(cl, clbl)


    pycno.cno(oldfile.crs_proj4).drawstates(ax=fca.axs)
    fca.fig.savefig(figpath)


.. _sphx_glr_download_auto_examples_maps_ex_maps_01_compare.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: ex_maps_01_compare.ipynb <ex_maps_01_compare.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: ex_maps_01_compare.py <ex_maps_01_compare.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: ex_maps_01_compare.zip <ex_maps_01_compare.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
